var FormParser=function(a){function b(){String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return b=b||0,this.indexOf(a,b)===b})}function c(a){$.ajax({url:a,success:function(a){0==a.isOk?alert(a.message):t=a},async:!1})}function d(){$(document).ready(function(){$(".selectWrapper > select").each(function(){g(this)}),$(".selectWrapper > select").change(function(){g(this)})})}function e(){function a(a,d){for(var e=0;e<d.length;e++){var f=d[e];b(f.name)&&(f.isParametrized?(a[f.name]={value:f.value,params:{}},c(a,d,f)):a[f.name]=f.value)}}function b(a){return 1==a.split(".").length}function c(b,c,d){for(var e=[],f=d.name+"."+d.value,g=0;g<c.length;g++){var h=c[g].name;if(h.startsWith(f)){var i=h.substring(f.length+1);e.push({name:i,value:c[g].value,isParametrized:c[g].isParametrized})}}a(b[d.name].params,e)}var d={},e=[];return $(".formElement").each(function(){var a=$(this).attr("name"),b=f(this),c=$(this).hasClass("parametrized");e.push({name:a,value:b,isParametrized:c})}),a(d,e),JSON.stringify(d)}function f(a){return"checkbox"==$(a).attr("type")?$(a).is(":checked"):$(a).val()}function g(a){var b="";$(a).find("option:selected").each(function(){b=$(this).attr("value")});var c="> div.optionalForm";$(a).parent().find(c).each(function(){var a=$(this).attr("name");a==b?$(this).css("display","block"):$(this).css("display","none")})}function h(a){var b='<div class="formWrapper">';b+="<h1>"+t.forms[a].label+"</h1>",b+='<input type="hidden" class="formElement" id="formElem_type" name="type" value="'+a+'">';for(var c=l(t.forms[a].elements),d=l(t.each.elements),e=d.concat(c),f=0;f<e.length;f++)b+=m(e[f],e[f].name);return b+='<button id="btnDiagramSettingsOK">OK</button>',b+="</div>"}function i(a){j(a,"formElem_")}function j(a,b){for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];if(d.hasOwnProperty("params")){var e=b+c+"."+d.value+".";k(b+c,a[c].value,!0),j(d.params,e)}else"value"!=c&&k(b+c,a[c],!1)}}function k(a,b,c){var d='[id="'+a+'"]',e=$(d);c?$(d+" option[value="+b+"]").prop("selected",!0):"checkbox"==e.attr("type")?e.prop("checked",b):"text"==e.attr("type")&&$(d).val(b)}function l(a){return void 0==a?[]:a}function m(a,b){var c="<h2>"+a.label+"</h2>",d=a.type;return"select"==d?c+=n(a,b):"integer"==d?c+=p(b):"text"==d?c+=o(b):"float"==d?c+=q(b):"boolean"==d&&(c+=r(b)),c+="<br>"}function n(a,b){var c='<div class="selectWrapper" name="'+a.name+'">';c+='<select class="formElement parametrized" id="formElem_'+b+'" name='+b+">";for(var d=a.options,e=0;e<d.length;e++){var f=d[e];c+='<option value="'+f.value+'">'+f.label+"</option>\n"}return c+="</select>",c+=s(d,a,b),c+="</div>"}function o(a){return'<input type="text" class="formElement" id="formElem_'+a+'" name="'+a+'">'}function p(a){return'<input type="text" class="formElement" id="formElem_'+a+'" name="'+a+'">'}function q(a){return'<input type="text" class="formElement" id="formElem_'+a+'" name="'+a+'">'}function r(a){return'<input type="checkbox" class="formElement" id="formElem_'+a+'" name="'+a+'">'}function s(a,b,c){for(var d="",e=0;e<a.length;e++){var f=a[e];if(d+='<div name="'+f.value+'" class="optionalForm">',void 0!=f.form){var g=f.form.elements;if(void 0!=g)for(var e=0;e<g.length;e++){var h=c+"."+f.value+"."+g[e].name;d+=m(g[e],h)}}d+="</div>"}return d}var t="";return c(a),b(),{getForm:h,setBehavior:d,formToJSON:e,setValues:i}};
//# sourceMappingURL=../../../maps/custom/diagram/form-parser.js.map